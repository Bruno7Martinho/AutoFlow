<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popular Oficinas - AutoFlow</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        .populate-container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
        }
        
        .populate-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .progress-area {
            margin: 20px 0;
            display: none;
        }
        
        .progress-bar {
            height: 30px;
            background-color: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .log-area {
            background: #2d2d2d;
            color: #fff;
            padding: 15px;
            border-radius: 6px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            margin: 20px 0;
        }
        
        .log-success { color: #4CAF50; }
        .log-error { color: #f44336; }
        .log-info { color: #2196F3; }
        
        .stats-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .config-group {
            margin: 20px 0;
        }
        
        .config-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .config-item {
            flex: 1;
        }
        
        .config-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .config-item input,
        .config-item select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
        }
        
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <div class="logo">
                <h1>AutoFlow <span style="font-size: 14px; color: #ffc107;">Populate</span></h1>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="admin-dashboard.html">Dashboard</a></li>
                    <li><a href="admin-oficinas.html">Oficinas</a></li>
                    <li><a href="populate-oficinas.html" class="active">Popular</a></li>
                </ul>
            </nav>
            <div class="user-info" id="user-info"></div>
        </header>

        <main class="main-content">
            <div class="populate-container">
                <div class="populate-card">
                    <h2 class="text-center">üöÄ Populador de Oficinas</h2>
                    <p class="text-center">Crie m√∫ltiplas oficinas para teste automaticamente</p>
                    
                    <div id="login-warning" class="warning-box" style="display: none;">
                        ‚ö†Ô∏è Voc√™ precisa estar logado como admin para usar esta ferramenta.
                    </div>
                    
                    <div class="config-group" id="config-section">
                        <h3>Configura√ß√µes</h3>
                        
                        <div class="config-row">
                            <div class="config-item">
                                <label>Quantidade de Oficinas</label>
                                <input type="number" id="qtd-oficinas" min="1" max="100" value="20">
                            </div>
                            <div class="config-item">
                                <label>Clientes por Oficina</label>
                                <input type="number" id="qtd-clientes" min="0" max="50" value="5">
                            </div>
                        </div>
                        
                        <div class="config-row">
                            <div class="config-item">
                                <label>Distribui√ß√£o dos Planos</label>
                                <select id="distribuicao-planos">
                                    <option value="balanceado">Balanceado (33% cada)</option>
                                    <option value="mais-basico">Mais B√°sico (60% b√°sico)</option>
                                    <option value="mais-completo">Mais Completo (60% completo)</option>
                                    <option value="realista">Realista (50% b√°sico, 30% intermedi√°rio, 20% completo)</option>
                                </select>
                            </div>
                            <div class="config-item">
                                <label>Status</label>
                                <select id="distribuicao-status">
                                    <option value="realista">Realista (80% ativa, 15% bloqueada, 5% inativa)</option>
                                    <option value="todas-ativas">Todas Ativas</option>
                                    <option value="variado">Variado</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="config-row">
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="criar-clientes" checked>
                                    Criar clientes para as oficinas
                                </label>
                            </div>
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="criar-veiculos" checked>
                                    Criar ve√≠culos para os clientes
                                </label>
                            </div>
                        </div>
                        
                        <div class="config-row">
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="criar-orcamentos" checked>
                                    Criar or√ßamentos aleat√≥rios
                                </label>
                            </div>
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="manter-dados" checked>
                                    Manter dados existentes
                                </label>
                            </div>
                        </div>
                        
                        <div class="stats-box">
                            <h4>üìä Pr√©via:</h4>
                            <p><strong>Oficinas:</strong> <span id="preview-oficinas">20</span></p>
                            <p><strong>Clientes:</strong> <span id="preview-clientes">100</span></p>
                            <p><strong>Ve√≠culos:</strong> <span id="preview-veiculos">200</span></p>
                            <p><strong>Or√ßamentos:</strong> ‚âà <span id="preview-orcamentos">150</span></p>
                        </div>
                        
                        <div class="warning-box">
                            ‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Isso criar√° muitos documentos no Firestore.
                            Certifique-se de que est√° em ambiente de teste.
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button id="btn-popular" class="btn btn-success btn-block">üöÄ Iniciar Popula√ß√£o</button>
                            <button id="btn-limpar" class="btn btn-danger">üóëÔ∏è Limpar Tudo</button>
                        </div>
                    </div>
                    
                    <div class="progress-area" id="progress-area">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill">0%</div>
                        </div>
                        <div class="log-area" id="log-area"></div>
                    </div>
                    
                    <div id="result-area"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/firebase-config.js"></script>
    <script>
        // Dados para popular
        const cidadesRS = [
            'Porto Alegre', 'Canoas', 'S√£o Leopoldo', 'Novo Hamburgo', 'Gravata√≠',
            'Cachoeirinha', 'Esteio', 'Sapucaia do Sul', 'Viam√£o', 'Alvorada',
            'Santa Maria', 'Pelotas', 'Rio Grande', 'Passo Fundo', 'Caxias do Sul',
            'Bento Gon√ßalves', 'Gramado', 'Canela', 'Torres', 'Uruguaiana'
        ];
        
        const nomesOficinas = [
            'Auto Mec√¢nica', 'Oficina do Povo', 'Mec√¢nica R√°pida', 'Auto Center',
            'Oficina Central', 'Mec√¢nica Express', 'Auto Socorro', 'Oficina Modelo',
            'Mec√¢nica de Confian√ßa', 'Auto T√©cnica', 'Oficina Elite', 'Mec√¢nica Premium',
            'Auto Service', 'Oficina Popular', 'Mec√¢nica Uni√£o', 'Auto Reparos',
            'Oficina S√£o Jorge', 'Mec√¢nica Santa Clara', 'Auto Norte', 'Oficina Sul'
        ];
        
        const sobrenomes = [
            'Silva', 'Santos', 'Oliveira', 'Souza', 'Rodrigues', 'Ferreira',
            'Alves', 'Pereira', 'Lima', 'Gomes', 'Costa', 'Ribeiro', 'Martins',
            'Carvalho', 'Almeida', 'Lopes', 'Soares', 'Fernandes', 'Vieira', 'Barbosa'
        ];
        
        const nomes = [
            'Jo√£o', 'Maria', 'Jos√©', 'Ana', 'Pedro', 'Paulo', 'Carlos', 'Marcos',
            'Lucas', 'Gabriel', 'Rafael', 'Fernanda', 'Juliana', 'Camila', 'Patr√≠cia',
            'Roberto', 'Ricardo', 'Eduardo', 'Bruno', 'Thiago'
        ];
        
        const veiculos = [
            { marca: 'Fiat', modelos: ['Uno', 'Palio', 'Toro', 'Strada', 'Mobi'] },
            { marca: 'Volkswagen', modelos: ['Gol', 'Polo', 'T-Cross', 'Saveiro', 'Voyage'] },
            { marca: 'Chevrolet', modelos: ['Onix', 'Prisma', 'Tracker', 'S10', 'Spin'] },
            { marca: 'Ford', modelos: ['Ka', 'Fiesta', 'Ranger', 'Ecosport', 'Focus'] },
            { marca: 'Toyota', modelos: ['Corolla', 'Hilux', 'Yaris', 'Etios', 'SW4'] },
            { marca: 'Honda', modelos: ['Civic', 'Fit', 'HR-V', 'City', 'WR-V'] },
            { marca: 'Renault', modelos: ['Sandero', 'Logan', 'Duster', 'Kwid', 'Captur'] },
            { marca: 'Hyundai', modelos: ['HB20', 'Creta', 'Tucson', 'ix35', 'Santa Fe'] },
            { marca: 'Jeep', modelos: ['Renegade', 'Compass', 'Grand Cherokee', 'Wrangler'] },
            { marca: 'Nissan', modelos: ['Kicks', 'Frontier', 'Versa', 'March', 'Sentra'] }
        ];
        
        document.addEventListener('DOMContentLoaded', function() {
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    const ADMIN_EMAILS = ['admin@autoflow.com', 'rafael@gmail.com', 'admin@gmail.com'];
                    
                    if (!ADMIN_EMAILS.includes(user.email)) {
                        document.getElementById('login-warning').style.display = 'block';
                        document.getElementById('config-section').style.display = 'none';
                        return;
                    }
                    
                    loadUserInfo(user);
                    atualizarPreview();
                } else {
                    document.getElementById('login-warning').style.display = 'block';
                    document.getElementById('config-section').style.display = 'none';
                }
            });
            
            // Atualizar preview
            document.getElementById('qtd-oficinas').addEventListener('input', atualizarPreview);
            document.getElementById('qtd-clientes').addEventListener('input', atualizarPreview);
            
            function atualizarPreview() {
                const oficinas = parseInt(document.getElementById('qtd-oficinas').value) || 0;
                const clientes = parseInt(document.getElementById('qtd-clientes').value) || 0;
                
                document.getElementById('preview-oficinas').textContent = oficinas;
                document.getElementById('preview-clientes').textContent = oficinas * clientes;
                document.getElementById('preview-veiculos').textContent = oficinas * clientes * 2;
                document.getElementById('preview-orcamentos').textContent = Math.round(oficinas * clientes * 0.6);
            }
            
            // Bot√£o popular
            document.getElementById('btn-popular').addEventListener('click', popularOficinas);
            
            // Bot√£o limpar
            document.getElementById('btn-limpar').addEventListener('click', limparTudo);
        });
        
        function loadUserInfo(user) {
            document.getElementById('user-info').innerHTML = `
                <span class="user-email">üëë ${user.email}</span>
                <button id="logout-btn" class="btn btn-sm btn-danger">Sair</button>
            `;
            document.getElementById('logout-btn').addEventListener('click', () => {
                sessionStorage.clear();
                auth.signOut();
                window.location.href = 'login.html';
            });
        }
        
        function log(message, type = 'info') {
            const logArea = document.getElementById('log-area');
            const entry = document.createElement('div');
            entry.className = `log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
            console.log(message);
        }
        
        function updateProgress(percent, message) {
            const fill = document.getElementById('progress-fill');
            fill.style.width = percent + '%';
            fill.textContent = percent + '%';
            if (message) log(message);
        }
        
        async function popularOficinas() {
            const qtdOficinas = parseInt(document.getElementById('qtd-oficinas').value);
            const qtdClientes = parseInt(document.getElementById('qtd-clientes').value);
            const criarClientes = document.getElementById('criar-clientes').checked;
            const criarVeiculos = document.getElementById('criar-veiculos').checked;
            const criarOrcamentos = document.getElementById('criar-orcamentos').checked;
            const manterDados = document.getElementById('manter-dados').checked;
            
            // Mostrar √°rea de progresso
            document.getElementById('progress-area').style.display = 'block';
            document.getElementById('log-area').innerHTML = '';
            document.getElementById('result-area').innerHTML = '';
            document.getElementById('btn-popular').disabled = true;
            
            log('üöÄ INICIANDO POPULA√á√ÉO DE OFICINAS...', 'info');
            log(`üìä Configura√ß√£o: ${qtdOficinas} oficinas, ${qtdClientes} clientes cada`, 'info');
            
            try {
                // Se n√£o manter dados, limpar existentes
                if (!manterDados) {
                    log('üóëÔ∏è Removendo dados existentes...', 'warning');
                    const snapshot = await db.collection('oficinas').get();
                    let count = 0;
                    for (const doc of snapshot.docs) {
                        await doc.ref.delete();
                        count++;
                        if (count % 10 === 0) log(`   ${count} oficinas removidas...`);
                    }
                    log(`‚úÖ ${count} oficinas removidas`, 'success');
                }
                
                let oficinasCriadas = 0;
                let clientesCriados = 0;
                let veiculosCriados = 0;
                let orcamentosCriados = 0;
                
                for (let i = 0; i < qtdOficinas; i++) {
                    // Escolher plano baseado na distribui√ß√£o
                    const plano = escolherPlano();
                    
                    // Gerar dados da oficina
                    const cidade = cidadesRS[Math.floor(Math.random() * cidadesRS.length)];
                    const nomeBase = nomesOficinas[Math.floor(Math.random() * nomesOficinas.length)];
                    const numero = Math.floor(Math.random() * 9000) + 100;
                    const status = escolherStatus();
                    
                    const oficinaData = {
                        nome: `${nomeBase} ${numero}`,
                        emailDono: `oficina${numero}@teste.com`,
                        telefone: gerarTelefone(),
                        whatsapp: gerarCelular(),
                        cnpj: gerarCNPJ(),
                        plano: plano,
                        status: status,
                        endereco: `Rua ${Math.floor(Math.random() * 1000)}`,
                        numero: Math.floor(Math.random() * 500) + 1,
                        bairro: 'Centro',
                        cidade: cidade,
                        uf: 'RS',
                        cep: gerarCEP(),
                        dataVencimento: gerarDataVencimento(),
                        observacoes: Math.random() > 0.7 ? 'Cliente desde ' + (2018 + Math.floor(Math.random() * 5)) : '',
                        createdAt: gerarDataAleatoria(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    // Salvar oficina
                    const oficinaRef = await db.collection('oficinas').add(oficinaData);
                    oficinasCriadas++;
                    
                    log(`‚úÖ Oficina ${i+1}/${qtdOficinas}: ${oficinaData.nome} (${plano})`, 'success');
                    
                    // Criar clientes se solicitado
                    if (criarClientes && qtdClientes > 0) {
                        const clientes = await criarClientesParaOficina(oficinaRef, qtdClientes, cidade);
                        clientesCriados += clientes.count;
                        veiculosCriados += clientes.veiculos;
                        orcamentosCriados += clientes.orcamentos;
                    }
                    
                    // Atualizar progresso
                    const percent = Math.round(((i + 1) / qtdOficinas) * 100);
                    updateProgress(percent, `Progresso: ${i+1}/${qtdOficinas} oficinas`);
                }
                
                // Resultado final
                log('üéâ‚úÖüéâ POPULA√á√ÉO CONCLU√çDA COM SUCESSO! üéâ‚úÖüéâ', 'success');
                
                const resultHtml = `
                    <div class="success-box">
                        <h3>‚úÖ Popula√ß√£o Conclu√≠da!</h3>
                        <p><strong>üìä Resumo:</strong></p>
                        <ul>
                            <li>üè™ Oficinas: ${oficinasCriadas}</li>
                            <li>üë• Clientes: ${clientesCriados}</li>
                            <li>üöó Ve√≠culos: ${veiculosCriados}</li>
                            <li>üìù Or√ßamentos: ${orcamentosCriados}</li>
                        </ul>
                        <p><a href="admin-oficinas.html" class="btn btn-primary">Ver Oficinas</a></p>
                    </div>
                `;
                
                document.getElementById('result-area').innerHTML = resultHtml;
                
            } catch (error) {
                log(`‚ùå ERRO: ${error.message}`, 'error');
                console.error(error);
            } finally {
                document.getElementById('btn-popular').disabled = false;
            }
        }
        
        function escolherPlano() {
            const distribuicao = document.getElementById('distribuicao-planos').value;
            const rand = Math.random();
            
            switch(distribuicao) {
                case 'balanceado':
                    if (rand < 0.33) return 'basico';
                    if (rand < 0.66) return 'intermediario';
                    return 'completo';
                    
                case 'mais-basico':
                    if (rand < 0.6) return 'basico';
                    if (rand < 0.8) return 'intermediario';
                    return 'completo';
                    
                case 'mais-completo':
                    if (rand < 0.2) return 'basico';
                    if (rand < 0.4) return 'intermediario';
                    return 'completo';
                    
                case 'realista':
                default:
                    if (rand < 0.5) return 'basico';
                    if (rand < 0.8) return 'intermediario';
                    return 'completo';
            }
        }
        
        function escolherStatus() {
            const distribuicao = document.getElementById('distribuicao-status').value;
            const rand = Math.random();
            
            switch(distribuicao) {
                case 'todas-ativas':
                    return 'ativa';
                    
                case 'variado':
                    if (rand < 0.7) return 'ativa';
                    if (rand < 0.9) return 'bloqueada';
                    return 'inativa';
                    
                case 'realista':
                default:
                    if (rand < 0.8) return 'ativa';
                    if (rand < 0.95) return 'bloqueada';
                    return 'inativa';
            }
        }
        
        async function criarClientesParaOficina(oficinaRef, qtd, cidade) {
            let clientesCount = 0;
            let veiculosCount = 0;
            let orcamentosCount = 0;
            
            for (let c = 0; c < qtd; c++) {
                const nomeCliente = gerarNomeCliente();
                const clienteData = {
                    nome: nomeCliente,
                    telefone: gerarCelular(),
                    email: `${nomeCliente.toLowerCase().replace(/\s/g, '.')}@email.com`,
                    cpf: gerarCPF(),
                    endereco: `Rua ${Math.floor(Math.random() * 1000)}`,
                    numero: Math.floor(Math.random() * 500) + 1,
                    bairro: 'Centro',
                    cidade: cidade,
                    uf: 'RS',
                    cep: gerarCEP(),
                    createdAt: gerarDataAleatoria()
                };
                
                const clienteRef = await oficinaRef.collection('clientes').add(clienteData);
                clientesCount++;
                
                // Criar ve√≠culos para o cliente
                if (document.getElementById('criar-veiculos').checked) {
                    const numVeiculos = Math.floor(Math.random() * 2) + 1; // 1-2 ve√≠culos
                    for (let v = 0; v < numVeiculos; v++) {
                        const veiculo = veiculos[Math.floor(Math.random() * veiculos.length)];
                        const modelo = veiculo.modelos[Math.floor(Math.random() * veiculo.modelos.length)];
                        
                        await clienteRef.collection('veiculos').add({
                            marca: veiculo.marca,
                            modelo: modelo,
                            ano: 2015 + Math.floor(Math.random() * 8),
                            placa: gerarPlaca(),
                            cor: gerarCor(),
                            km: Math.floor(Math.random() * 150000) + 10000
                        });
                        veiculosCount++;
                    }
                }
                
                // Criar or√ßamentos
                if (document.getElementById('criar-orcamentos').checked && Math.random() > 0.5) {
                    const numOrcamentos = Math.floor(Math.random() * 3) + 1; // 1-3 or√ßamentos
                    for (let o = 0; o < numOrcamentos; o++) {
                        const servicos = gerarServicos();
                        await clienteRef.collection('orcamentos').add({
                            numero: 'OR-' + Date.now().toString().slice(-8) + o,
                            data: gerarDataAleatoria(),
                            servicos: servicos,
                            valorTotal: servicos.reduce((acc, s) => acc + s.total, 0),
                            status: ['pendente', 'aprovado', 'recusado', 'concluido'][Math.floor(Math.random() * 4)]
                        });
                        orcamentosCount++;
                    }
                }
            }
            
            return { count: clientesCount, veiculos: veiculosCount, orcamentos: orcamentosCount };
        }
        
        // Fun√ß√µes geradoras
        function gerarTelefone() {
            const ddd = Math.floor(Math.random() * (99 - 11 + 1)) + 11;
            const num = Math.floor(Math.random() * 9000) + 1000;
            return `(${ddd}) ${num}-${Math.floor(Math.random() * 9000) + 1000}`;
        }
        
        function gerarCelular() {
            const ddd = Math.floor(Math.random() * (99 - 11 + 1)) + 11;
            const num = Math.floor(Math.random() * 90000) + 10000;
            return `(${ddd}) 9${num}`;
        }
        
        function gerarCNPJ() {
            return `${Math.floor(Math.random() * 90) + 10}.${Math.floor(Math.random() * 900) + 100}.${Math.floor(Math.random() * 900) + 100}/0001-${Math.floor(Math.random() * 90) + 10}`;
        }
        
        function gerarCPF() {
            return `${Math.floor(Math.random() * 900) + 100}.${Math.floor(Math.random() * 900) + 100}.${Math.floor(Math.random() * 900) + 100}-${Math.floor(Math.random() * 90) + 10}`;
        }
        
        function gerarCEP() {
            return `${Math.floor(Math.random() * 90000) + 10000}-${Math.floor(Math.random() * 900) + 100}`;
        }
        
        function gerarPlaca() {
            const letras = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let placa = '';
            for (let i = 0; i < 3; i++) placa += letras[Math.floor(Math.random() * 26)];
            placa += Math.floor(Math.random() * 10);
            placa += letras[Math.floor(Math.random() * 26)];
            placa += Math.floor(Math.random() * 100);
            return placa;
        }
        
        function gerarCor() {
            const cores = ['Preto', 'Branco', 'Prata', 'Vermelho', 'Azul', 'Cinza', 'Verde', 'Amarelo'];
            return cores[Math.floor(Math.random() * cores.length)];
        }
        
        function gerarNomeCliente() {
            const nome = nomes[Math.floor(Math.random() * nomes.length)];
            const sobrenome = sobrenomes[Math.floor(Math.random() * sobrenomes.length)];
            const sobrenome2 = Math.random() > 0.5 ? ' ' + sobrenomes[Math.floor(Math.random() * sobrenomes.length)] : '';
            return `${nome} ${sobrenome}${sobrenome2}`;
        }
        
        function gerarDataAleatoria() {
            const start = new Date(2022, 0, 1);
            const end = new Date();
            return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime())).toISOString();
        }
        
        function gerarDataVencimento() {
            const data = new Date();
            data.setMonth(data.getMonth() + Math.floor(Math.random() * 3) + 1);
            return data.toISOString().split('T')[0];
        }
        
        function gerarServicos() {
            const servicosPossiveis = [
                { descricao: 'Troca de √≥leo', valor: 150 },
                { descricao: 'Alinhamento', valor: 80 },
                { descricao: 'Balanceamento', valor: 60 },
                { descricao: 'Revis√£o completa', valor: 450 },
                { descricao: 'Troca de pastilhas de freio', valor: 280 },
                { descricao: 'Troca de pneus', valor: 800 },
                { descricao: 'Limpeza de bicos', valor: 200 },
                { descricao: 'Troca de correia dentada', valor: 650 },
                { descricao: 'Troca de amortecedores', valor: 1200 },
                { descricao: 'Alinhamento e balanceamento', valor: 120 }
            ];
            
            const numServicos = Math.floor(Math.random() * 3) + 1;
            const servicos = [];
            
            for (let i = 0; i < numServicos; i++) {
                const s = servicosPossiveis[Math.floor(Math.random() * servicosPossiveis.length)];
                const qtd = Math.floor(Math.random() * 2) + 1;
                servicos.push({
                    descricao: s.descricao,
                    quantidade: qtd,
                    valorUnitario: s.valor,
                    total: s.valor * qtd
                });
            }
            
            return servicos;
        }
        
        async function limparTudo() {
            if (!confirm('‚ö†Ô∏è ISSO VAI APAGAR TODAS AS OFICINAS E DADOS! Tem certeza?')) return;
            if (!confirm('üî¥ √öLTIMA CHAMADA! Esta a√ß√£o √© IRREVERS√çVEL!')) return;
            
            try {
                const snapshot = await db.collection('oficinas').get();
                let count = 0;
                
                for (const doc of snapshot.docs) {
                    await doc.ref.delete();
                    count++;
                }
                
                alert(`‚úÖ ${count} oficinas apagadas com sucesso!`);
                
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao limpar: ' + error.message);
            }
        }
    </script>
</body>
</html>